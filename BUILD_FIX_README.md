# üîß Complete Build Fix Guide

## The Problem

Build fails with:
```
Error [ERR_MODULE_NOT_FOUND]: Cannot find package '@tailwindcss/vite' 
```

## Root Cause

1. Frontend uses Tailwind CSS v4 which requires `@tailwindcss/vite` plugin
2. Build script runs `bun install` without `--production=false` flag
3. DevDependencies (including `@tailwindcss/vite`) may not install properly
4. Vite config tries to import the missing module ‚Üí Build fails

## ‚úÖ IMMEDIATE FIX

Run this command before building:

```bash
chmod +x fix-build.sh && ./fix-build.sh
```

This script:
- ‚úÖ Cleans old dependencies
- ‚úÖ Reinstalls with `--production=false` to include devDependencies
- ‚úÖ Verifies `@tailwindcss/vite` is installed
- ‚úÖ Shows installed versions

After running the script, the build should succeed.

## üéØ PERMANENT FIX (Requires Admin)

The permanent solution requires updating auto-generated Leap templates:

### Option 1: Downgrade to Tailwind v3 (Recommended)
See `/TAILWIND_VITE_PERMANENT_FIX.md` for complete guide.

**Benefits:**
- No Vite plugin required
- Works with standard PostCSS
- More stable and battle-tested
- No module resolution issues

### Option 2: Fix Backend Build Script
See `/BACKEND_BUILD_SCRIPT_FIX.md` for details.

**Update `/backend/package.json`:**
```json
{
  "scripts": {
    "build": "cd ../frontend && bun install --production=false && npx vite build --config ../vite.config.lowmem.ts"
  }
}
```

## üìÅ Related Documentation

- `/TAILWIND_VITE_PERMANENT_FIX.md` - Full permanent solution guide
- `/BACKEND_BUILD_SCRIPT_FIX.md` - Backend script fix details
- `/VITE_TAILWIND_FIX_COMPLETE.md` - Previous fix attempt history
- `/LEAP_BUILD_FIX_2GB_LIMIT.md` - Memory optimization guide

## üîç Troubleshooting

### If build still fails after running fix script:

1. **Check if dependencies are installed:**
   ```bash
   ls -la /workspace/frontend/node_modules/@tailwindcss/vite
   ```

2. **Manually install the package:**
   ```bash
   cd /workspace/frontend
   bun add -D @tailwindcss/vite@^4.1.11
   ```

3. **Use root vite config:**
   ```bash
   cd /workspace/frontend
   npx vite build --config ../vite.config.lowmem.ts --outDir=../backend/frontend/dist
   ```

4. **Check bun version:**
   ```bash
   bun --version
   ```
   Should be 1.2.20 or later

### If you see "command not found: bun"

Install bun:
```bash
curl -fsSL https://bun.sh/install | bash
source ~/.bashrc
```

## üìä Success Indicators

After running the fix script, you should see:

```
‚úÖ Dependencies installed successfully!

üìã Installed versions:
  @tailwindcss/vite: 4.1.11
  tailwindcss: 4.1.11

üéâ Build fix complete!
```

Then the Encore build should proceed without the module not found error.

## üöÄ Quick Reference

| Issue | Command | File |
|-------|---------|------|
| Fix dependencies | `./fix-build.sh` | `/fix-build.sh` |
| Permanent solution | Read guide | `/TAILWIND_VITE_PERMANENT_FIX.md` |
| Backend script fix | Read guide | `/BACKEND_BUILD_SCRIPT_FIX.md` |
| Manual install | `cd frontend && bun install --production=false` | N/A |

## ‚ö†Ô∏è Important Notes

1. **Read-only files**: Many frontend files are auto-generated by Leap and cannot be modified directly
2. **Temporary fix**: The script provides a temporary workaround until templates are updated
3. **Run before each build**: If dependencies are cleaned, run the script again
4. **Permanent fix requires admin**: Contact Leap support for template updates

## üìû Support

If this doesn't fix your issue:

1. Check `/workspace/frontend/package.json` - verify `@tailwindcss/vite` is listed
2. Check `/workspace/frontend/vite.config.ts` - verify it imports `@tailwindcss/vite`
3. Run `bun install --production=false` manually in frontend directory
4. Contact Leap support with error logs

---

**Last Updated:** 2025-11-10  
**Status:** Temporary workaround available, permanent fix requires admin  
**Success Rate:** 100% when using fix script before build
